#!/bin/bash
# strict mode http://redsymbol.net/articles/unofficial-bash-strict-mode/
set -uo pipefail
IFS=$'\n\t'

dir="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
project="${PWD##*/}"
bins=("behat" "composer" "drupal" "drush" "lint" "php" "phpcs" "phpmd" "phpunit" "simpletest")

deactivate () {
	for bin in "${bins[@]}"
	do
		unalias "$bin"
	done

	if ! [ -z "${_OLD_PS1+_}" ] ; then
        PS1="$_OLD_PS1"
        export PS1
        unset _OLD_PS1
    fi
}

if [ "$(type -t drush)" == "alias" ]; then
	echo "Already activated!"
else
	for bin in "${bins[@]}"
	do
		alias "$bin=$dir/$bin"
	done

	_OLD_PS1="$PS1"
	PS1="\e[1;35m(Docker $project)\e[0m $PS1"
	export PS1
fi
